<section class="audit-plan">
  <header class="plan-header">
    <div>
      <p class="eyebrow">Audit planning</p>
      <h1>Audit plan details</h1>
      <p class="subtitle">Capture the key details needed to manage the audit plan.</p>
    </div>
    <div class="header-actions">
      <button class="ghost" type="button" (click)="cancel(planForm)">Cancel</button>
      <button class="primary" type="button" (click)="createAudit(planForm)">
        Create Audit
      </button>
    </div>
  </header>

  <form class="plan-form" #planForm="ngForm">
    <div class="field">
      <label>Start Date <span class="req">*</span></label>
      <input
        type="date"
        name="startDate"
        [(ngModel)]="auditForm.startDate"
        required
      />
    </div>
    <div class="field">
      <label>End Date <span class="req">*</span></label>
      <input
        type="date"
        name="endDate"
        [(ngModel)]="auditForm.endDate"
        required
      />
    </div>
    <div class="field">
      <label>Audit Type <span class="req">*</span></label>
      <select name="auditType" [(ngModel)]="auditForm.auditType" required>
        <option value="">Select audit type</option>
        <option *ngFor="let type of auditTypes" [value]="type">{{ type }}</option>
      </select>
    </div>
    <div class="field">
      <label>Audit Subtype</label>
      <input
        type="text"
        name="auditSubtype"
        [(ngModel)]="auditForm.auditSubtype"
        placeholder="Optional subtype"
      />
    </div>
    <div class="field">
      <label>Auditor Name</label>
      <input
        type="text"
        name="auditorName"
        [(ngModel)]="auditForm.auditorName"
        placeholder="Optional auditor name"
      />
    </div>
    <div class="field">
      <label>Department</label>
      <input
        type="text"
        name="department"
        [(ngModel)]="auditForm.department"
        placeholder="Optional department"
      />
    </div>
    <div class="field">
      <label>Location (City)</label>
      <input
        type="text"
        list="city-list"
        placeholder="Select or type city"
        name="locationCity"
        [(ngModel)]="auditForm.locationCity"
        [disabled]="!auditForm.country"
      />
      <datalist id="city-list">
        <option *ngFor="let city of cities" [value]="city"></option>
      </datalist>
    </div>
    <div class="field">
      <label>Site</label>
      <input
        type="text"
        name="site"
        [(ngModel)]="auditForm.site"
        placeholder="Configured in settings"
      />
      <small>Optional. Sites are configured in Settings.</small>
    </div>
    <div class="field">
      <label>Country</label>
      <select [(ngModel)]="auditForm.country" name="country">
        <option value="">Select country</option>
        <option value="India">India</option>
        <option value="USA">USA</option>
        <option value="Canada">Canada</option>
      </select>
    </div>
    <div class="field">
      <label>Region</label>
      <input
        type="text"
        name="region"
        [(ngModel)]="auditForm.region"
        placeholder="Configured in settings"
      />
      <small>Optional. Regions are configured in Settings.</small>
    </div>
    <div class="field full">
      <label>Audit Note</label>
      <textarea
        rows="6"
        maxlength="100"
        placeholder="Add up to 100 characters"
        name="auditNote"
        [(ngModel)]="auditForm.auditNote"
        (input)="updateNoteChars(auditForm.auditNote)"
      ></textarea>
      <div class="note-meta">
        <span>Optional. Add context or special instructions.</span>
        <span [class.limit]="noteChars >= 100">{{ noteChars }}/100 characters</span>
      </div>
    </div>
  </form>
</section>
