<section class="audit-perform">
  <header class="page-header">
    <div>
      <p class="eyebrow">Audit execution</p>
      <h1>Audit perform</h1>
      <p class="subtitle">Review and execute all created audit plans.</p>
    </div>
    <div class="header-actions">
      <label class="filter">
        From
        <input type="date" [(ngModel)]="filterStart" name="filterStart" />
      </label>
      <label class="filter">
        To
        <input type="date" [(ngModel)]="filterEnd" name="filterEnd" />
      </label>
      <label class="filter">
        Sort
        <select [(ngModel)]="sortOrder" name="sortOrder">
          <option value="desc">Newest first</option>
          <option value="asc">Oldest first</option>
        </select>
      </label>
    </div>
  </header>

  <section class="panel wide">
    <div class="panel-header">
      <h2>Created audits</h2>
      <span class="count">{{ audits.length }} total</span>
    </div>
    <div class="table-row heading">
      <span>Audit code</span>
      <span>Dates</span>
      <span>Audit type</span>
      <span>Subtype</span>
      <span>Auditor</span>
      <span>Department</span>
      <span>Country</span>
      <span>City</span>
      <span>Site</span>
      <span>Region</span>
      <span>Note</span>
      <span>Action</span>
    </div>
    <div class="table-row" *ngFor="let audit of audits">
      <span class="code">{{ audit.code }}</span>
      <span>{{ audit.startDate }} → {{ audit.endDate }}</span>
      <span>{{ audit.auditType }}</span>
      <span>{{ audit.auditSubtype || '—' }}</span>
      <span>{{ audit.auditorName || '—' }}</span>
      <span>{{ audit.department || '—' }}</span>
      <span>{{ audit.country || '—' }}</span>
      <span>{{ audit.locationCity || '—' }}</span>
      <span>{{ audit.site || '—' }}</span>
      <span>{{ audit.region || '—' }}</span>
      <span>{{ audit.auditNote || '—' }}</span>
      <span>
        <button class="primary small" type="button" (click)="openPerform(audit)">Perform</button>
      </span>
    </div>
    <div class="empty" *ngIf="!audits.length">
      No audits created yet. Create one in Audit Plan.
    </div>
  </section>

  <div class="drawer-backdrop" *ngIf="activeAudit">
    <aside class="drawer">
      <header class="drawer-header">
        <div>
          <h2>Audit perform</h2>
          <p class="subtitle">
            {{ activeAudit.auditType }} · {{ activeAudit.code }}
          </p>
        </div>
        <button class="ghost small" type="button" (click)="closePerform()">Close</button>
      </header>

      <section class="drawer-content">
        <h3>Template questions</h3>
        <div class="empty" *ngIf="!activeTemplate">
          No template found for this audit type.
        </div>
        <ol class="question-list" *ngIf="activeTemplate">
          <li *ngFor="let question of activeTemplate.questions">{{ question }}</li>
        </ol>
      </section>
    </aside>
  </div>
</section>
