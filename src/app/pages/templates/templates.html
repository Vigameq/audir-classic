<section class="templates">
  <header class="page-header">
    <div>
      <p class="eyebrow">Audit templates</p>
      <h1>Templates</h1>
      <p class="subtitle">Import spreadsheet questions for audit execution.</p>
    </div>
    <div class="header-actions">
      <button class="ghost" type="button" (click)="openImportModal()">
        Import
      </button>
    </div>
  </header>

  <section class="panel">
    <div class="panel-header">
      <h2>Questions</h2>
      <span class="count">{{ questions.length }} total</span>
    </div>
    <p class="error" *ngIf="importError">{{ importError }}</p>
    <div class="loading" *ngIf="isImporting">Importing…</div>
    <ol class="question-list" *ngIf="questions.length">
      <li *ngFor="let question of questions">{{ question }}</li>
    </ol>
    <div class="empty" *ngIf="!questions.length && !isImporting">
      No questions imported yet.
    </div>
  </section>

  <div class="modal-backdrop" *ngIf="showImportModal">
    <div class="modal">
      <header>
        <h2>Import questions</h2>
        <button class="icon" type="button" (click)="closeImportModal()">Close</button>
      </header>
      <div class="modal-body">
        <p class="hint">Upload a single-sheet .xlsx with one column of questions.</p>
        <label class="ghost file-button">
          Choose file
          <input type="file" accept=".xlsx" (change)="onFileSelected($event)" />
        </label>
        <div class="note">
          <label>Import note (optional)</label>
          <textarea
            rows="2"
            maxlength="100"
            placeholder="Add up to 100 characters"
            name="importNote"
            [(ngModel)]="importNote"
            (input)="updateNoteChars(importNote)"
          ></textarea>
          <div class="note-meta">
            <span>Optional note saved with this import.</span>
            <span [class.limit]="noteChars >= 100">{{ noteChars }}/100</span>
          </div>
        </div>
        <div class="tags">
          <label>Tags (up to 3)</label>
          <div class="tag-input">
            <input
              type="text"
              name="tagInput"
              [(ngModel)]="tagInput"
              placeholder="Add a tag"
              [disabled]="tags.length >= 3"
            />
            <button class="ghost" type="button" (click)="addTag()" [disabled]="tags.length >= 3">
              Add tag
            </button>
          </div>
          <div class="note-meta">
            <span>{{ tags.length }}/3 tags used</span>
          </div>
          <div class="tag-list" *ngIf="tags.length">
            <span class="tag" *ngFor="let tag of tags">
              {{ tag }}
              <button type="button" class="remove" (click)="removeTag(tag)">×</button>
            </span>
          </div>
        </div>
      </div>
      <footer>
        <button class="ghost" type="button" (click)="closeImportModal()">Cancel</button>
      </footer>
    </div>
  </div>
</section>
